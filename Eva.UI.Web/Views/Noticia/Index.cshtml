@using Eva.Dominio
@using PagedList.Mvc
@model PagedList.IPagedList<Eva.Dominio.Noticia>


<ul id="tiles">
    <!-- These are our grid blocks -->
    @foreach (var noticia in Model)
    {
        <li>
            @{var arquivo = noticia.Arquivos.FirstOrDefault() ?? new Arquivo();}
            <a href="@Url.Action("Ler", "Noticia", new {Area = "", slugNoticia = noticia.Slug, slugCategoria = noticia.Categoria.Slug, slugLocal = noticia.Local.Slug})" title="@noticia.Titulo">
                <img src="@Foto.Placehold(arquivo.Nome, "464x474", "Noticia", "464x474_")" alt="@arquivo.Legenda" />
            </a>
            <div class="post-info">
                <div class="post-basic-info">
                    <h3>
                        <a href="@Url.Action("Ler", "Noticia", new {Area = "", slugNoticia = noticia.Slug, slugCategoria = noticia.Categoria.Slug, slugLocal = noticia.Local.Slug})" title="@noticia.Titulo">@noticia.Titulo</a>
                    </h3>
                    <span>
                        <a href="@Url.Action("Index", "Noticia", new {Area = "", categoria = noticia.Categoria.Slug})">
                            <label> </label>@noticia.Categoria.Nome
                        </a>
                    </span>
                    <p>@noticia.Resumo</p>
                </div>
                <div class="post-info-rate-share">
                    <div class="rateit">
                        <span> </span>
                    </div>
                    <div class="post-share">
                        <span> </span>
                    </div>
                    <div class="clear"> </div>
                </div>
            </div>
        </li>
    }
    <!-- End of grid blocks -->
</ul>

<!----wookmark-scripts---->
<script src="~/Content/Site/web/js/jquery.imagesloaded.js"></script>
<script src="~/Content/Site/web/js/jquery.wookmark.js"></script>
<script type="text/javascript">
    (function ($) {
        var $tiles = $('#tiles'),
            $handler = $('li', $tiles),
            $main = $('#main'),
            $window = $(window),
            $document = $(document),
            options = {
                autoResize: true, // This will auto-update the layout when the browser window is resized.
                container: $main, // Optional, used for some extra CSS styling
                offset: 20, // Optional, the distance between grid items
                itemWidth: 280 // Optional, the width of a grid item
            };
        /**
         * Reinitializes the wookmark handler after all images have loaded
         */
        function applyLayout() {
            $tiles.imagesLoaded(function () {
                // Destroy the old handler
                if ($handler.wookmarkInstance) {
                    $handler.wookmarkInstance.clear();
                }

                // Create a new layout handler.
                $handler = $('li', $tiles);
                $handler.wookmark(options);
            });
        }
        /**
         * When scrolled all the way to the bottom, add more tiles
         */
        function onScroll() {
            // Check if we're within 100 pixels of the bottom edge of the broser window.
            var winHeight = window.innerHeight ? window.innerHeight : $window.height(), // iphone fix
                closeToBottom = ($window.scrollTop() + winHeight > $document.height() - 100);

            if (closeToBottom) {
                // Get the first then items from the grid, clone them, and add them to the bottom of the grid
                var $items = $('li', $tiles),
                    $firstTen = $items.slice(0, 10);
                $tiles.append($firstTen.clone());

                //applyLayout();
            }
        };

        // Call the layout function for the first time
        applyLayout();

        // Capture scroll event.
        $window.bind('scroll.wookmark', onScroll);
    })(jQuery);
</script>
<!----//wookmark-scripts---->

<div class="paginacao mgn-top-20px">
    @Html.PagedListPager(Model, page => Url.Action("Index", new { page = page }))
</div>